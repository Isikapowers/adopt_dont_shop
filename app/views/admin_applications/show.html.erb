<div class="card">
  <div class="card-header">
    <h3>Application for <%= @application.applicant_name %> </h3>
  </div>
  <div class="card-body">
    <h5 class="card-title">Application Status:  <%= @application.status %></h5><br>
    <h5 class="card-text">Description on why they would make a good owner for the pet(s):</h5>
    <ul><%= @application.description %></ul><br>

    <h5>Pets Applying For:</h5><br>
    <% @application.pets.each do |pet| %>
      <ul>
        <li><h5>Name: <%= link_to pet.name, "/pets/#{pet.id}" %></h5>
          <h5>Adoptable: <%= pet.adoptable %> </h5><br>
        <div id="pet-<%= pet.id %>">
          <% if @application.status == "Approved" %>
            <a class="badge badge-success"><h5>Application has been approved.</h5></a>
          <% elsif @application.status == "Rejected" %>
            <a class="badge badge-danger"><h5>Application has been rejected.</h5></a>
          <% else %>
            <% if pet.adoptable == false %>
            <% @application.update_attribute(:status, "Rejected") %>
            <% else %>
            <%= form_with url: "/admin/applications/#{@application.id}?status=Approved", method: :patch, local: true do |f| %>
               <%= f.hidden_field :status, value: "Approved" %>
               <%= f.hidden_field :pet_id, value: pet.id %>
              <%= f.submit "Approve Application", class: "btn btn-info" %>
            <% end %>
            <%= form_with url: "/admin/applications/#{@application.id}?status=Rejected", method: :patch, local: true do |f| %>
              <%= f.hidden_field :status, value: "Rejected" %>
              <%= f.hidden_field :pet_id, value: pet.id %>
              <%= f.submit "Reject Application", class: "btn btn-warning" %>
            <% end %>
            <% end %>
          <% end %>
        </div>
        </li>
      </ul>
    <% end %>
  </div>
</div>
